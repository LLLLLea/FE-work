# 进程管理

## 前台进程与后台进程

1. `前台进程`：在shell提示处键入命令后，系统创建一个子进程运行命令，shell等待命令退出，然后返回到给出提示符到用户。
这条命令在前台运行，即，用户在它执行完毕之前不能执行其他命令。
2. `后台进程`：在shell中键入命令后，跟一个`&`符号，shell创建子进程运行该条命令但不等待命令退出，直接返回到给予用户提示的界面。
这样的进程叫后台进程，后台命令必须是非交互的。

## 查看用户信息的命令：w

`w`： 命令显示信息的含义：

- JCPU: 以终端代号区分，该终端所有相关的进程执行时，所消耗的CPU时间会显示在这里
- PCPU: CPU执行程序所耗费的时间
- WHAT: 用户正在执行的操作

`w 用户名`： 查看某个用户的信息

- load average： 分别显示系统在过去1、5、15分钟内的平均负载程度
- FROM： 指示用户从何处登录
- IDLE： 用户闲置时间

## 查看进程信息的命令：ps（process state）

常用选项：

- a：显示所有用户的进程
- u：显示用户名和启动时间
- x：显示没有控制终端的进程
- e：显示所有进程，包括没有控制终端的进程
- l：长格式显示
- w：宽行显示，可以使用多个w加宽显示, 例如 `ps -alwww`

最常用的形式：

- ps
- ps -u or -l
- ps -le or -aux
- ps -aux --sort pid：可按进程id、执行时间、UID等对进程排序
- ps -le | grep init：筛选查看某个进程的信息
- ps -u 用户名： 查看某个用户相关的进程
- pstree: 查看进程的树状信息

使用ps命令显示的进程字段信息的含义：

- PID：进程号
- PPID： 父进程的进程号
- TTY：进程启动的终端
- STAT：进程状态，S休眠，D不可中断的休眠状态，R运行状态，Z僵尸状态，T停止状态
- NI：进程优先级
- TIME：进程自启动以来占用的CPU时间
- COMMAND/CMD：进程命令名
- USER：用户名
- %CPU：占用CPU时间和总时间的百分比
- %MEM：占用内存与系统内存总量的百分比

## 杀死进程的命令：kill

- kill 进程号
- kill -9 进程号： 强制杀死进程
- kill -l 进程号： 重启进程
- xkill：关闭图形程序
- killall：结束所有进程
- pgrep 服务名称： 查找某个服务的进程号， 例如： `pgrep nginx` 获取nginx服务的进程号！
- pkill 进程名称： 直接通过进程名称杀死进程！

## 进程优先级设置命令： nice 和 renice

`nice`用于指定进程的优先级，`renice`用于改变进程的优先级，Linux中进程优先级的范围为`-20~19`。

- `nice --n command`： 指定程序优先级(注意：两个-)，例如 `nice -5 myprogram`
- `renice -n pid`：修改程序优先级，根据进程id修改，例如`renice -5 777`

## 使进程在用户退出登录后继续执行：nohup

命令格式： `nohup program &`，例如备份数据库等耗时很长的命令，使用`nohup`能使用户登出后继续在后台执行，
该命令执行后的数据信息和错误信息默认会保存到nohup.out文件中。

## 进程的挂起与恢复

- 挂起：`ctrl + z`
- 终止：`ctrl + c`
- 恢复到前台继续执行： `fg`
- 恢复到后台继续执行： `bg`
- 查看被挂起的进程： `jobs`

## 查看进程信息的另一个命令： top

    进程状态显示和进程控制，每5秒钟自动刷新一次，动态显示。能显示系统进程数、线程数、CPU/MEMORY/NET等详细信息。
    
常用选项：

- d：指定刷新间隔
- c：显示整个命令行而不仅仅显示命令名

